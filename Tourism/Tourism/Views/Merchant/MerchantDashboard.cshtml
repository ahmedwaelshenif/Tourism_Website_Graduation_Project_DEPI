@using Tourism.ViewModel
@model MerchantDashboardViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Merchant Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />

    <style>
        :root {
            --eggplant: #614051;
            --eggplant-light: #8B5A7D;
            --eggplant-dark: #3D2938;
            --accent: #C77D9E;
            --bg-light: #F8F5F7;
        }

        body {
            background-color: var(--bg-light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Navbar */
        .navbar {
            background: white !important;
            box-shadow: 0 2px 8px rgba(97, 64, 81, 0.1);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--eggplant) !important;
        }

        .nav-link {
            color: var(--eggplant-dark) !important;
            font-weight: 500;
            transition: color 0.3s;
        }

            .nav-link:hover {
                color: var(--eggplant-light) !important;
            }

            .nav-link.text-danger {
                color: #dc3545 !important;
            }

        .merchant-info {
            padding: 0.5rem 1rem;
            cursor: default;
        }

            .merchant-info:hover {
                color: var(--eggplant-dark) !important;
            }

        .star-rating {
            display: flex;
            align-items: center;
            gap: 0.15rem;
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }

            .star-rating i {
                color: #ffa500;
            }

            .star-rating .bi-star {
                color: #ddd;
            }

        .rating-text {
            margin-left: 0.4rem;
            font-size: 0.8rem;
            color: #666;
            font-weight: 600;
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, var(--eggplant) 0%, var(--eggplant-light) 100%);
            padding: 4rem 0 5rem;
            margin-top: 0;
            position: relative;
            overflow: hidden;
        }

            .hero-section::before {
                content: '';
                position: absolute;
                top: 0;
                right: 0;
                width: 500px;
                height: 500px;
                background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
                border-radius: 50%;
                transform: translate(30%, -30%);
            }

            .hero-section::after {
                content: '';
                position: absolute;
                bottom: 0;
                left: 0;
                width: 400px;
                height: 400px;
                background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%);
                border-radius: 50%;
                transform: translate(-30%, 30%);
            }

        .hero-content {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .hero-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            color: white;
            padding: 0.5rem 1.25rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

            .hero-badge i {
                margin-right: 0.4rem;
                color: #ffd700;
            }

        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            color: white;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .gradient-text {
            background: linear-gradient(135deg, #fff 0%, #f0e6ed 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-subtitle {
            font-size: 1.15rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 2.5rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-top: 2rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 0.5rem;
        }

        .stat-divider {
            width: 1px;
            height: 50px;
            background: rgba(255, 255, 255, 0.3);
        }

        /* Modern Action Cards */
        .modern-card-link {
            text-decoration: none;
            display: block;
        }

        .modern-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            border: 2px solid transparent;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

            .modern-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 4px;
                background: linear-gradient(90deg, var(--eggplant), var(--accent));
                transform: scaleX(0);
                transition: transform 0.4s ease;
            }

            .modern-card:hover {
                transform: translateY(-8px);
                border-color: var(--eggplant-light);
                box-shadow: 0 20px 40px rgba(97, 64, 81, 0.15);
            }

                .modern-card:hover::before {
                    transform: scaleX(1);
                }

                .modern-card:hover .card-arrow {
                    transform: translateX(8px);
                    opacity: 1;
                }

                .modern-card:hover .card-icon {
                    transform: scale(1.1) rotate(5deg);
                }

        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            transition: all 0.4s ease;
            color: white;
        }

        .products-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .orders-icon {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .add-icon {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .card-content {
            flex: 1;
        }

        .modern-card-title {
            font-size: 1.35rem;
            font-weight: 700;
            color: var(--eggplant);
            margin-bottom: 0.75rem;
        }

        .modern-card-text {
            font-size: 0.95rem;
            color: #6c757d;
            line-height: 1.6;
            margin: 0;
        }

        .card-arrow {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            font-size: 1.5rem;
            color: var(--eggplant);
            opacity: 0.5;
            transition: all 0.4s ease;
        }

        /* Reviews Section */
        .reviews-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(97, 64, 81, 0.1);
            overflow: hidden;
            border: 1px solid #e8e0e5;
        }

        .reviews-header {
            background: linear-gradient(135deg, #ffa500 0%, #ff8c00 100%);
            padding: 1.25rem 1.5rem;
            color: white;
        }

            .reviews-header h5 {
                margin: 0;
                font-weight: 600;
                font-size: 1.25rem;
            }

                .reviews-header h5 i {
                    margin-right: 0.5rem;
                }

        .reviews-body {
            padding: 2rem 1.5rem;
        }

        .average-rating {
            text-align: center;
            padding-bottom: 2rem;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 2rem;
        }

        .avg-number {
            font-size: 3.5rem;
            font-weight: 800;
            color: #ffa500;
            line-height: 1;
        }

        .avg-stars {
            display: flex;
            justify-content: center;
            gap: 0.3rem;
            font-size: 1.5rem;
            margin: 0.75rem 0;
        }

            .avg-stars i {
                color: #ffa500;
            }

            .avg-stars .bi-star {
                color: #ddd;
            }

        .avg-text {
            color: #666;
            font-size: 0.95rem;
            margin-top: 0.5rem;
        }

        .rating-bars {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .rating-bar-item {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .rating-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #333;
            min-width: 40px;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

            .rating-label i {
                color: #ffa500;
                font-size: 0.85rem;
            }

        .rating-bar-container {
            flex: 1;
            height: 24px;
            background: #f0f0f0;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .rating-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffa500 0%, #ff8c00 100%);
            transition: width 0.6s ease;
            border-radius: 12px;
        }

        .rating-count {
            font-size: 0.9rem;
            font-weight: 600;
            color: #666;
            min-width: 40px;
            text-align: right;
        }

        /* Reviews List */
        .reviews-list-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(97, 64, 81, 0.1);
            overflow: hidden;
            border: 1px solid #e8e0e5;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .reviews-list-header {
            background: linear-gradient(135deg, var(--eggplant) 0%, var(--eggplant-light) 100%);
            padding: 1.25rem 1.5rem;
            color: white;
        }

            .reviews-list-header h5 {
                margin: 0 0 1rem 0;
                font-weight: 600;
                font-size: 1.25rem;
            }

                .reviews-list-header h5 i {
                    margin-right: 0.5rem;
                }

        .filter-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.4rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

            .filter-btn:hover {
                background: rgba(255, 255, 255, 0.2);
                border-color: rgba(255, 255, 255, 0.5);
            }

            .filter-btn.active {
                background: white;
                color: var(--eggplant);
                border-color: white;
                font-weight: 600;
            }

        .reviews-list-body {
            padding: 1.5rem;
            overflow-y: auto;
            max-height: 500px;
            flex: 1;
        }

            .reviews-list-body::-webkit-scrollbar {
                width: 8px;
            }

            .reviews-list-body::-webkit-scrollbar-track {
                background: #f0f0f0;
                border-radius: 10px;
            }

            .reviews-list-body::-webkit-scrollbar-thumb {
                background: var(--eggplant-light);
                border-radius: 10px;
            }

                .reviews-list-body::-webkit-scrollbar-thumb:hover {
                    background: var(--eggplant);
                }

        .review-item {
            padding: 1.25rem;
            border: 1px solid #e8e0e5;
            border-radius: 12px;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            background: white;
            display: flex;
            gap: 1rem;
        }

            .review-item:hover {
                box-shadow: 0 4px 12px rgba(97, 64, 81, 0.1);
                border-color: var(--eggplant-light);
            }

            .review-item.hidden {
                display: none;
            }

        .review-avatar {
            flex-shrink: 0;
        }

            .review-avatar i {
                font-size: 2.5rem;
                color: var(--eggplant-light);
            }

        .review-content {
            flex: 1;
        }

        .review-header-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .review-date {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            color: #666;
            font-size: 0.9rem;
        }

            .review-date i {
                color: var(--eggplant);
            }

        .review-stars {
            display: flex;
            gap: 0.15rem;
            font-size: 0.9rem;
        }

            .review-stars i {
                color: #ffa500;
            }

            .review-stars .bi-star {
                color: #ddd;
            }

        .review-comment {
            color: #333;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .no-reviews {
            text-align: center;
            padding: 3rem 1rem;
            color: #999;
        }

            .no-reviews i {
                font-size: 3rem;
                display: block;
                margin-bottom: 1rem;
                opacity: 0.5;
            }

            .no-reviews p {
                margin: 0;
                font-size: 1.1rem;
            }

        /* Sales Summary Card */
        .card-summary {
            border-radius: 12px;
            height: 100%;
            border: none;
            box-shadow: 0 2px 8px rgba(97, 64, 81, 0.1);
            overflow: hidden;
        }

        .card-header {
            border-top-left-radius: 12px !important;
            border-top-right-radius: 12px !important;
            background: linear-gradient(135deg, var(--eggplant) 0%, var(--eggplant-light) 100%) !important;
            border: none !important;
        }

            .card-header h5 {
                margin-bottom: 0;
                font-weight: 600;
            }

        .table {
            margin-bottom: 0;
        }

            .table thead {
                background-color: var(--bg-light);
            }

                .table thead th {
                    color: var(--eggplant-dark);
                    font-weight: 600;
                    border-bottom: 2px solid var(--eggplant-light);
                }

            .table tbody td {
                color: #333;
            }

        .table-bordered {
            border-color: #e8e0e5;
        }

        /* Chart Container */
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(97, 64, 81, 0.1);
            height: 100%;
            border: 1px solid #e8e0e5;
        }

            .chart-container h5 {
                color: var(--eggplant);
                margin-bottom: 15px;
                font-weight: 600;
            }

        /* Inbox Styles */
        .inbox-wrapper {
            position: relative;
            display: inline-block;
        }

        .inbox-toggle {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            cursor: pointer;
            border: none;
            background: none;
            color: var(--eggplant-dark);
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s;
        }

            .inbox-toggle:hover {
                background-color: var(--bg-light);
                color: var(--eggplant);
            }

        .badge-custom {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: #fff;
            border-radius: 999px;
            padding: .2rem .45rem;
            font-size: .72rem;
            font-weight: 600;
        }

        .inbox-menu {
            position: absolute;
            right: 0;
            top: calc(100% + .5rem);
            width: 320px;
            background: white;
            border: 1px solid #e8e0e5;
            box-shadow: 0 6px 18px rgba(97, 64, 81, 0.15);
            border-radius: 12px;
            display: none;
            z-index: 1050;
            overflow: hidden;
        }

            .inbox-menu.open {
                display: block;
                animation: slideDown 0.3s ease;
            }

        @@keyframes slideDown {
            from

        {
            opacity: 0;
            transform: translateY(-10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }

        }

        .inbox-item {
            padding: .75rem 1rem;
            border-bottom: 1px solid #f1f1f1;
            color: #333;
            transition: background 0.2s;
        }

            .inbox-item:last-child {
                border-bottom: none;
            }

            .inbox-item:hover {
                background-color: var(--bg-light);
            }

        .inbox-empty {
            padding: 1.5rem;
            text-align: center;
            color: #6c757d;
        }

        /* Link styling */
        a.text-decoration-none.text-dark:hover {
            text-decoration: none !important;
        }

        /* Responsive */
        @@media (max-width: 768px) {
            .hero-title

        {
            font-size: 2rem;
        }

        .hero-subtitle {
            font-size: 1rem;
        }

        .hero-stats {
            flex-direction: column;
            gap: 1.5rem;
        }

        .stat-divider {
            display: none;
        }

        .modern-card {
            padding: 1.5rem;
        }

        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-shop"></i> Tourism
            </a>
            <div class="collapse navbar-collapse justify-content-end">
                <div class="navbar-nav align-items-center" style="gap: .5rem;">
                    <!-- Inbox -->
                    <div class="inbox-wrapper" id="inboxWrapper">
                        <button type="button" class="inbox-toggle" id="inboxToggle">
                            <i class="bi bi-envelope"></i>
                            <span>Inbox</span>
                            @if (Model.msg != null && Model.msg.Any())
                            {
                                <span id="msgBadge" class="badge-custom">@Model.msg.Count()</span>
                            }
                        </button>
                        <div class="inbox-menu" id="inboxMenu">
                            @if (Model.msg != null && Model.msg.Any())
                            {
                                foreach (var message in Model.msg)
                                {
                                    <div class="inbox-item">
                                        <i class="bi bi-chat-dots me-2"></i>@message
                                    </div>
                                }
                            }
                            else
                            {
                                <div class="inbox-empty">
                                    <i class="bi bi-inbox" style="font-size: 2rem; display: block; margin-bottom: 0.5rem;"></i>
                                    No messages found
                                </div>
                            }
                        </div>
                    </div>

                    <div class="nav-link merchant-info">
                        <div class="d-flex flex-column align-items-start">
                            <div class="d-flex align-items-center gap-2">
                                <i class="bi bi-person-circle"></i>
                                <span>@Model.name</span>
                            </div>
                            <div class="star-rating">
                                @for (int i = 1; i <= 5; i++)
                                {
                                    if (i <= Model.rate)
                                    {
                                        <i class="bi bi-star-fill"></i>
                                    }
                                    else
                                    {
                                        <i class="bi bi-star"></i>
                                    }
                                }
                                <span class="rating-text">@Model.rate.0/5.0</span>
                            </div>
                        </div>
                    </div>
                    <a class="nav-link" href="#">
                        <i class="bi bi-question-circle"></i> Help
                    </a>
                    <a class="nav-link text-danger" asp-action="Logout" asp-controller="Merchant">
                        <i class="bi bi-box-arrow-right"></i> Log Out
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="hero-content">
                <div class="hero-badge">
                    <i class="bi bi-star-fill"></i> Merchant Dashboard
                </div>
                <h1 class="hero-title">
                    Welcome back, <span class="gradient-text">@Model.name</span>
                </h1>
                <p class="hero-subtitle">
                    Manage your store, track sales, and grow your business all in one place
                </p>
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-value">@Model.total[3]</div>
                        <div class="stat-label">Revenue (30d)</div>
                    </div>
                    <div class="stat-divider"></div>
                    <div class="stat-item">
                        <div class="stat-value">@Model.units[3]</div>
                        <div class="stat-label">Units Sold</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Container -->
    <div class="container mt-5">
        <!-- Quick Actions Section -->
        <div class="section-header mb-4">
            <h2 class="section-title">Quick Actions</h2>
            <p class="section-subtitle">Access your most used features</p>
        </div>

        <div class="row justify-content-center g-4 mb-5">
            <div class="col-lg-4 col-md-6">
                <a asp-action="ShowProducts" asp-controller="Merchant" class="modern-card-link">
                    <div class="modern-card">
                        <div class="card-icon products-icon">
                            <i class="bi bi-box-seam"></i>
                        </div>
                        <div class="card-content">
                            <h6 class="modern-card-title">Products</h6>
                            <p class="modern-card-text">Manage and view all available products easily</p>
                        </div>
                        <div class="card-arrow">
                            <i class="bi bi-arrow-right"></i>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col-lg-4 col-md-6">
                <a asp-action="ShowOrders" asp-controller="Merchant" class="modern-card-link">
                    <div class="modern-card">
                        <div class="card-icon orders-icon">
                            <i class="bi bi-cart-check"></i>
                        </div>
                        <div class="card-content">
                            <h6 class="modern-card-title">Orders</h6>
                            <p class="modern-card-text">Track customer orders and update their status</p>
                        </div>
                        <div class="card-arrow">
                            <i class="bi bi-arrow-right"></i>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col-lg-4 col-md-6">
                <a asp-action="AddProduct" asp-controller="Merchant" class="modern-card-link">
                    <div class="modern-card">
                        <div class="card-icon add-icon">
                            <i class="bi bi-plus-circle"></i>
                        </div>
                        <div class="card-content">
                            <h6 class="modern-card-title">Add Product</h6>
                            <p class="modern-card-text">Quickly add new products to your store inventory</p>
                        </div>
                        <div class="card-arrow">
                            <i class="bi bi-arrow-right"></i>
                        </div>
                    </div>
                </a>
            </div>
        </div>

        <!-- Analytics Section -->
        <div class="section-header mb-4 mt-5">
            <h2 class="section-title">Sales Analytics</h2>
            <p class="section-subtitle">Track your performance and revenue</p>
        </div>

        <div class="row g-4 mb-5">
            <!-- Sales Summary -->
            <div class="col-lg-6">
                <div class="card card-summary">
                    <div class="card-header text-white">
                        <h5>
                            <i class="bi bi-graph-up-arrow"></i> Sales Summary
                        </h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-bordered text-center align-middle mb-0">
                            <thead>
                                <tr>
                                    <th>Period</th>
                                    <th>Sales ($)</th>
                                    <th>Units</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Today</strong></td>
                                    <td>@Model.total[0]</td>
                                    <td>@Model.units[0]</td>
                                </tr>
                                <tr>
                                    <td><strong>Last 7 Days</strong></td>
                                    <td>@Model.total[1]</td>
                                    <td>@Model.units[1]</td>
                                </tr>
                                <tr>
                                    <td><strong>Last 14 Days</strong></td>
                                    <td>@Model.total[2]</td>
                                    <td>@Model.units[2]</td>
                                </tr>
                                <tr>
                                    <td><strong>Last 30 Days</strong></td>
                                    <td>@Model.total[3]</td>
                                    <td>@Model.units[3]</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Annual Earnings Chart -->
            <div class="col-lg-6">
                <div class="chart-container">
                    <h5>
                        <i class="bi bi-bar-chart-line"></i> Annual Earnings ($)
                    </h5>
                    <canvas id="earningsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Reviews Section -->
        <div class="section-header mb-4 mt-5">
            <h2 class="section-title">Customer Feedback</h2>
            <p class="section-subtitle">See what your customers are saying</p>
        </div>
        <div class="row g-4">
            <!-- Rating Distribution Chart -->
            <div class="col-lg-5">
                <div class="reviews-card">
                    <div class="reviews-header">
                        <h5>
                            <i class="bi bi-star-fill text-warning"></i> Customer Reviews
                        </h5>
                    </div>
                    <div class="reviews-body">
                        <!-- Average Rating -->
                        <div class="average-rating">
                            <div class="avg-number">@Model.rate.0</div>
                            <div class="avg-stars">
                                @for (int i = 1; i <= 5; i++)
                                {
                                    if (i <= Model.rate)
                                    {
                                        <i class="bi bi-star-fill"></i>
                                    }
                                    else
                                    {
                                        <i class="bi bi-star"></i>
                                    }
                                }
                            </div>
                            <div class="avg-text">
                                @{
                                    int totalReviews = 0;
                                    if (Model.reviews != null)
                                    {
                                        foreach (var reviewList in Model.reviews)
                                        {
                                            totalReviews += reviewList.Count;
                                        }
                                    }
                                }
                                Based on @totalReviews reviews
                            </div>
                        </div>

                        <!-- Rating Bars -->
                        <div class="rating-bars">
                            @if (Model.reviews != null)
                            {
                                @for (int star = 5; star >= 0; star--)
                                {
                                    int count = Model.reviews[star].Count;
                                    double percentage = totalReviews > 0 ? (count * 100.0 / totalReviews) : 0;
                                    <div class="rating-bar-item">
                                        <div class="rating-label">
                                            @star <i class="bi bi-star-fill"></i>
                                        </div>
                                        <div class="rating-bar-container">
                                            <div class="rating-bar-fill" style="width: @percentage%"></div>
                                        </div>
                                        <div class="rating-count">@count</div>
                                    </div>
                                }
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reviews List -->
            <div class="col-lg-7">
                <div class="reviews-list-card">
                    <div class="reviews-list-header">
                        <h5>
                            <i class="bi bi-chat-left-text"></i> Review Details
                        </h5>
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-rating="all">All</button>
                            @for (int i = 5; i >= 0; i--)
                            {
                                <button class="filter-btn" data-rating="@i">@i ★</button>
                            }
                        </div>
                    </div>
                    <div class="reviews-list-body" id="reviewsContainer">
                        @if (Model.reviews != null && totalReviews > 0)
                        {
                            @for (int star = 5; star >= 0; star--)
                            {
                                foreach (var review in Model.reviews[star])
                                {
                                    <div class="review-item" data-rating="@star">
                                        <div class="review-avatar">
                                            <i class="bi bi-person-circle"></i>
                                        </div>
                                        <div class="review-content">
                                            <div class="review-header-item">
                                                <div class="review-date">
                                                    <i class="bi bi-calendar3"></i>
                                                    <span>@review.CreatedAt.ToString("MMM dd, yyyy")</span>
                                                </div>
                                                <div class="review-stars">
                                                    @for (int i = 1; i <= 5; i++)
                                                    {
                                                        if (i <= star)
                                                        {
                                                            <i class="bi bi-star-fill"></i>
                                                        }
                                                        else
                                                        {
                                                            <i class="bi bi-star"></i>
                                                        }
                                                    }
                                                </div>
                                            </div>
                                            <div class="review-comment">
                                                @review.Comment
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        }
                        else
                        {
                            <div class="no-reviews">
                                <i class="bi bi-inbox"></i>
                                <p>No reviews yet</p>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // Chart setup with eggplant colors
        const ctx = document.getElementById('earningsChart').getContext('2d');
        const earningsData = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.annualEarnings));

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Monthly Earnings',
                    data: earningsData,
                    borderColor: '#614051',
                    backgroundColor: 'rgba(97, 64, 81, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointRadius: 5,
                    pointBackgroundColor: '#614051',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointHoverRadius: 7,
                    pointHoverBackgroundColor: '#8B5A7D',
                    borderWidth: 3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Earnings ($)',
                            color: '#614051',
                            font: { weight: 'bold', size: 13 }
                        },
                        ticks: { color: '#614051' },
                        grid: { color: 'rgba(97, 64, 81, 0.1)' }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Month',
                            color: '#614051',
                            font: { weight: 'bold', size: 13 }
                        },
                        ticks: { color: '#614051' },
                        grid: { color: 'rgba(97, 64, 81, 0.1)' }
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(97, 64, 81, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#8B5A7D',
                        borderWidth: 1
                    }
                }
            }
        });
    </script>

    <!-- Inbox Script -->
    <script>
        const toggle = document.getElementById('inboxToggle');
        const menu = document.getElementById('inboxMenu');
        const wrapper = document.getElementById('inboxWrapper');
        const badge = document.getElementById('msgBadge');

        toggle?.addEventListener('click', e => {
            e.stopPropagation();
            menu.classList.toggle('open');
            if (badge) badge.style.display = 'none';
        });

        document.addEventListener('click', e => {
            if (!wrapper.contains(e.target)) {
                menu.classList.remove('open');
            }
        });
    </script>

    <!-- Reviews Filter Script -->
    <script>
        const filterButtons = document.querySelectorAll('.filter-btn');
        const reviewItems = document.querySelectorAll('.review-item');

        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all buttons
                filterButtons.forEach(b => b.classList.remove('active'));
                // Add active class to clicked button
                btn.classList.add('active');

                const filterRating = btn.getAttribute('data-rating');

                reviewItems.forEach(item => {
                    if (filterRating === 'all') {
                        item.classList.remove('hidden');
                    } else {
                        const itemRating = item.getAttribute('data-rating');
                        if (itemRating === filterRating) {
                            item.classList.remove('hidden');
                        } else {
                            item.classList.add('hidden');
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>