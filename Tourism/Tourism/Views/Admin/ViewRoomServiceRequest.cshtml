@model Tourism.ViewModel.RoomViewModel
@{
    ViewData["Title"] = "View Room";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />

<style>
    :root {
        --primary-purple: #6f42c1; /* Darker purple from the dashboard header */
        --light-purple: #9d7fe3; /* Lighter purple for accents */
        --card-bg: #ffffff;
        --text-color: #333;
        --heading-color: #4a4a4a;
        --border-color: #e0e0e0;
        --shadow-color: rgba(0, 0, 0, 0.1);
    }

    body {
        background-color: #f8f9fa; /* Light background to match dashboard content area */
        color: var(--text-color);
    }

    .card {
        border: none;
        border-radius: 0.75rem;
        box-shadow: 0 0.5rem 1rem var(--shadow-color);
    }

    .text-primary-custom {
        color: var(--primary-purple) !important;
    }

    .btn-custom-purple {
        background-color: var(--primary-purple);
        border-color: var(--primary-purple);
        color: white;
        transition: all 0.3s ease;
    }

        .btn-custom-purple:hover {
            background-color: var(--light-purple);
            border-color: var(--light-purple);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

    .btn-outline-custom-purple {
        color: var(--primary-purple);
        border-color: var(--primary-purple);
        background-color: transparent;
        transition: all 0.3s ease;
    }

        .btn-outline-custom-purple:hover {
            background-color: var(--primary-purple);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

    .badge-status {
        padding: 0.5em 0.75em;
        font-size: 0.85em;
        font-weight: 600;
        border-radius: 0.35rem;
    }

    .badge-approved {
        background-color: #28a745; /* Success green */
    }

    .badge-pending {
        background-color: #ffc107; /* Warning yellow */
        color: #333;
    }

    .image-container {
        position: relative;
    }

    /* تم إلغاء هذه التنسيقات لأننا حذفنا أزرار التنقل */
    /* .image-nav-btn { ... } */

    .thumbnail-img {
        transition: all 0.3s ease;
        border: 2px solid transparent; /* Default transparent border */
    }

        .thumbnail-img:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

    /* تم إلغاء هذا التنسيق لأننا حذفنا خاصية الصورة النشطة */
    /* .thumbnail-img.active-thumbnail { ... } */
</style>

<div class="container mt-5">
    <div class="card shadow-lg p-4 rounded-4">
        <h2 class="text-center mb-4 text-primary-custom fw-bold">Room @Model.number</h2>

        <div class="row">
            <div class="col-md-5">
                <h5 class="fw-bold mt-3 text-primary-custom">Room Details</h5>

                <div class="mb-3">
                    <strong>Room Number:</strong>
                    <span class="ms-2">@Model.number</span>
                </div>

                <div class="mb-3">
                    <strong>Guest Capacity:</strong>
                    <span class="ms-2">@Model.capacity guests</span>
                </div>

                <div class="mb-3">
                    <strong>Price per Night:</strong>
                    <span class="ms-2 text-success fw-semibold">$@Model.price</span>
                </div>

                <div class="mb-3">
                    <strong>Description:</strong>
                    <p class="mt-1">@Model.description</p>
                </div>

                <div class="mb-3">
                    <strong>Available Rooms:</strong>
                    <span class="ms-2">@Model.count</span>
                </div>

                @if (Model.offer)
                {
                    <div class="mb-3">
                        <strong>Discount:</strong>
                        <span class="ms-2 text-danger">@Model.discount%</span>
                    </div>
                }

                <div class="mb-3">
                    <strong>Status:</strong>
                    <span class="ms-2 badge badge-status @(Model.accepted ? "badge-approved" : "badge-pending")">
                        @(Model.accepted ? "Approved" : "Pending Approval")
                    </span>
                </div>

                <div class="mb-3">
                    <strong>Hotel ID:</strong>
                    <span class="ms-2">@Model.hotelid</span>
                </div>

                <div class="mb-3">
                    <strong>Room ID:</strong>
                    <span class="ms-2">@Model.id</span>
                </div>
            </div>

            <div class="col-md-7">
                <div class="room-image-container">
                    @{
                        var imageIds = Model.ImageIds;
                        var imageColSize = 3;
                        // تم زيادة الحجم إلى 250px
                        var imageHeight = 250;
                    }

                    @if (imageIds != null && imageIds.Any())
                    {
                        <div class="row g-0 justify-content-start align-items-center">

                            <div class="col-12">
                                <div class="row g-0 justify-content-start">
                                    @foreach (var imageId in imageIds.Take(4))
                                    {
                                        <div class="col-@imageColSize p-1">

                                            <img src="@Url.Action("GetImage", "Admin", new { imageId = imageId })"
                                                 alt="Room Image"
                                                 class="img-fluid rounded thumbnail-img"
                                                 style="height: @(imageHeight)px; width: 100%; object-fit: cover; cursor: pointer;"
                                                 onerror="this.onerror=null;this.src='https://via.placeholder.com/@(imageHeight)x@(imageHeight).png?text=Err';" />
                                        </div>

                                    }
                                </div>
                            </div>


                            @if (imageIds.Count > 4)
                            {

                                <div class="col-12 text-center text-muted" style="font-size: 0.8rem; padding-top: 5px;">
                                    + @(imageIds.Count - 4) more pictures
                                </div>

                            }
                        </div>

                    }
                    else
                    {

                        <img src="https://via.placeholder.com/600x450.png?text=No+Image"
                             alt="No Image"
                             class="room-image rounded-start" style="min-height: 450px; width: 100%; object-fit: cover;" />

                    }
                </div>
            </div>
        </div>

        <div class="mt-5 border-top pt-4">
            <h4 class="mb-3 fw-bold text-primary-custom">Review Actions</h4>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <form asp-controller="Admin" asp-action="AcceptRoom" method="post">
                        <input type="hidden" name="serviceId" value="@Model.id" />
                        <input type="hidden" name="providerId" value="@Model.hotelid" />
                        <button type="submit" class="btn btn-custom-purple w-100 py-2">
                            <i class="bi bi-check-circle me-2"></i>Accept Room
                        </button>
                    </form>
                </div>

                <div class="col-md-6 mb-3">
                    <form asp-controller="Admin" asp-action="DenyRoom" method="post">
                        <input type="hidden" name="serviceId" value="@Model.id" />
                        <input type="hidden" name="providerId" value="@Model.hotelid" />
                        <button type="submit" class="btn btn-outline-custom-purple w-100 py-2">
                            <i class="bi bi-x-circle me-2"></i>Reject Room
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        // ❌ تم حذف جميع Logic الصورة الرئيسية والتنقل (mainImage, prevBtn, nextBtn, updateMainImage)

        // Enable tooltips (تم الإبقاء عليها في حال استخدامها في أماكن أخرى)
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        const tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
</script>